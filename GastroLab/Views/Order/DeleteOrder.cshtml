@model GastroLab.Application.ViewModels.OrderVM

@{
    ViewData["Title"] = "DeleteOrder";
}

<h1>Delete Order</h1>

<h3>Are you sure you want to delete this order?</h3>

<div>
    <h4>Order Details</h4>
    <dl class="row">
        <!-- Order ID -->
        <dt class="col-sm-2">Order ID</dt>
        <dd class="col-sm-10">@Model.Id</dd>

        <!-- Total Price -->
        <dt class="col-sm-2">Total Price</dt>
        <dd class="col-sm-10">@Model.TotalPrice.ToString("F2") zł</dd>

        <!-- Delivery Method -->
        <dt class="col-sm-2">Delivery Method</dt>
        <dd class="col-sm-10">@Model.DeliveryMethod.ToString()</dd>

        <!-- Address Details -->
        @if (Model.DeliveryMethod == DeliveryMethod.Delivery && Model.Address != null)
        {
            <dt class="col-sm-2">Delivery Address</dt>
            <dd class="col-sm-10">
                <p>@Model.Address.City @Model.Address.Street @Model.Address.HouseNumber</p>
                @if (Model.Address.FlatNumber != null)
                {
                    <p>/@Model.Address.FlatNumber</p>
                }
            </dd>
        }
        else if (Model.DeliveryMethod == DeliveryMethod.DineIn)
        {
        <dt class="col-sm-2">Table Number</dt>
        <dd class="col-sm-10">@Model.TableNr</dd>
        }
        else if (Model.DeliveryMethod == DeliveryMethod.Pickup)
        {
        <dt class="col-sm-2">Pickup Time</dt>
        <dd class="col-sm-10">
            @(
                Model.ScheduledDeliveryDate.HasValue
                ? Model.ScheduledDeliveryDate.Value.ToString("dd.MM.yyyy HH:mm")
                : (Model.CreationDate + (Model.WaitingTime ?? TimeSpan.Zero)).ToString("dd.MM.yyyy HH:mm")
                )
        </dd>
        }

        <!-- Products -->
        <dt class="col-sm-2">Products</dt>
        <dd class="col-sm-10">
            <ul>
                @foreach (var product in Model.products)
                {
                    <li>
                        <strong>@product.Quantity x @product.Name</strong>
                        @if (product.OrderOptions != null && product.OrderOptions.Any())
                        {
                            <ul>
                                @foreach (var optionSet in product.OrderOptions)
                                {
                                    <li>- @optionSet.Option.Name</li>
                                }
                            </ul>
                        }
                    </li>
                }
            </ul>
        </dd>

        <!-- Order Comment -->
        @if (!string.IsNullOrEmpty(Model.Comment))
        {
            <dt class="col-sm-2">Note</dt>
            <dd class="col-sm-10">@Model.Comment</dd>
        }
    </dl>
</div>

<form asp-action="DeleteOrder" method="post">
    <input type="hidden" name="id" value="@Model.Id" />
    <button type="submit" class="btn btn-danger">Delete</button>
    <a asp-action="ManageAllOrders" class="btn btn-secondary">Cancel</a>
</form>
